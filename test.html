<nav class="navbar navbar-default navbar-static-top" role="navigation">
  <div class="container-fluid">
    <div class="navbar-header">
      <span class="navbar-brand">Final Deliverable: Impacts of Climate Change</span>
    </div>
    <ul class="nav navbar-nav" data-tabsetid="9880">
      <li class="active">
        <a href="#tab-9880-1" data-toggle="tab" data-value="Temperature Change Across Time">Temperature Change Across Time</a>
      </li>
      <li>
        <a href="#tab-9880-2" data-toggle="tab" data-value="Disaster Count Per Year">Disaster Count Per Year</a>
      </li>
      <li>
        <a href="#tab-9880-3" data-toggle="tab" data-value="Change in Temperature Between Years">Change in Temperature Between Years</a>
      </li>
    </ul>
  </div>
</nav>
<div class="container-fluid">
  <div class="tab-content" data-tabsetid="9880">
    <div class="tab-pane active" data-value="Temperature Change Across Time" id="tab-9880-1">
      <h2>Change in Mean Land Temperature Across Time and Correlations Between Countries</h2>
      <div class="col-sm-8">
        <h3>Correlations Between Countries for All Recorded Temperatures</h3>
        <div class = 'p1_paras'>
  <p>
    For our dataset 1, average land temperatures per country, we are interested in exploring the true impacts of climate change. Particularly we would like to determine how
    <span class = 'hint'>different countries</span>
    <span class = 'point'>correlate</span>
    with each other. We first take a look at some innate relationship between countries by examining all of the monthly mean land temperature measurments from 1743 to 2013 across all countries. We utilize the
    <span class = 'package'>countrycode</span>
    package to link countries to
    <span class = 'hint'>mega regions</span>,
    which are large conglomerations of countries that are geographically similar. They are not neccessarily continent based, as mega regions can spread across continents and not encompass an entire continent. Furthermore, as our dataset does not necessarily contain data for every single country we include a coloring called
    <span class = 'hint'>Not Considered</span>
    that indicates the country was not considered when calculating the heatmap and world map, and as such does not have a value or a grouping. Below, we plot the different mega regions on a world map to show where each mega region resides.
  </p>
</div>
        <div id="world_map_temp_mega_regions" style="width:100%; height:400px; " class="plotly html-widget html-widget-output shiny-report-size"></div>
        <div class = 'p1_paras'>
  <p>
    As seen above, each mega region has some geographical significance, in the sense that each mega region has a
    <span class = 'hint'>specific geographical profile</span>
    that is
    <span class = 'hint'>tied to a temperature profile</span>.
    Thus, we predict that when we examine the monthly mean land temperature measurments between countries, essentially their temperature profile, and utilize that dataset to
    <span class = 'point'>calculate correlations</span>
    between countries, we should see geographical significance in the clusters formed. Simply put, countries that are closely related together in terms of having similar temperature profiles should also have similar geographical profiles as the two are linked together. To test our hypothesis, we plot a correlation matrix shown below, that was calculated using
    <span class = 'hint'>Spearmann's correlation metric</span>
    via each countries' monthly mean land temperatures, and annotate the corresponding mega regions as a column annotation.
  </p>
</div>
        <div id="all_ct_temp_mega_corrmap" class="shiny-plot-output" style="width: 100% ; height: 400px"></div>
        <div class = 'p1_pars'> 
  <p>
    In order to more quantitatively show the geographical significance in the clustering results of monthly mean land temperature measurments, we utilize the
    <span class = 'package'>hclust</span>
    package to group and classify clusters via a cutoff of
    <span class = 'hint'>h = 0.5</span>.
    While we could have used
    <span class = 'hint'>k = # of clusters</span>,
    we wanted to use
    <span class = 'hint'>h</span>,
    as it provides a more empirical cutoff by cutting a line at a certain height, in this case 0.5, on the dendrogram (the clustering tree) instead of relying on a more artifical number of clusters. Since we use this same cutoff on heatmaps based on other data, their individual clusterings become comparable and we can examine how their differing dendrograms, at the same degree of correlation, cluster differently. Below we show the same correlation matrix as above except with the grouping, determined via the previously described cutoff, colored on as a column annotation, similarly to how we previously showed the distribution of mega regions.
  </p>
</div>
        <div id="all_ct_temp_grouped_corrmap" class="shiny-plot-output" style="width: 100% ; height: 400px"></div>
        <div class = 'p1_paras'>
  <p>
    Now, while we can see that there are mainly
    <span class = 'hint'><span class = 'point'>two groups</span>
    of highly correlated countries</span>
    it is a bit hard to understand where they are and what they mean. As such, we plot the groups onto a world map below to show the distribution of each of these groups.
  </p>
</div>
        <div id="world_map_temp_grouped" style="width:100%; height:400px; " class="plotly html-widget html-widget-output shiny-report-size"></div>
        <div class = 'p1_paras'>
  <p>
    As seen above, these two large groups have high geographical significance.
    <span class = 'hint'>Group 1 lies strictly above the equator</span>,
    and
    <span class = 'hint'>Group 2 lies strictly below it</span>.
    Thinking about the measurments taken, we can identify that we are seeing the correlations between countries on a
    <span class = 'hint'>monthly basis</span>
    and as such the
    <span class = 'point'>two main groups are a result of seasonal changes</span>.
    All of the countries in Group 1 move together across seasons, yet Group 2, because they lie on the opposite side of the earth will be moving through the opposite seasons. This explains the
    <span class = 'hint'>strong, negative correlation</span>
    between the two groups, and
    <span class = 'hint'>strong, positive correlation</span>
    within them. As these seasonal changes are overwhelmingly strong, any more minute changes are smothered, and we cannot draw insights that might point to overall temperature change. While we could average the years together, thereby eliminating the seasonal effect we would be losing valuable monthly information. As such we explore another option below that would help us maintain this monthly level information but also examine correlations between countries.
  </p>
</div>
        <hr/>
        <h3>EMD Distance Between Countries for Changes in Monthly Temperature Recordings</h3>
        <div class = 'p1_paras'>
  <p>
    Understanding the correlations between countries and their change in mean land temperature is <span class = 'hint'>crucial</span> to support the proper allocation of climate change prevention resources. As shown in the previous section, while monthly information is valuable, the seasonal effect is so overwhelming that we end up only seeing seasonal effects. As such, we need a way to identify countries that have similar changes in mean land temperature without being affected by seasonal changes in temperature. To do such, we implement a distance metric called <span class = 'point'>Wasserstein's distance metric</span>, also called <span class = 'hint'>Earth Mover's Distance or EMD</span>. Generally it can be thought of the energy need to transform one pile of earth, such as the one on the lower left, to another pile of earth, such as the one on the lower right.
  </p>
</div>
        <div class = 'image_text'>
  <link rel='stylesheet' href='app.css'>
  <img style='display: inline; margin-top: -100px; margin-right: -10px' title='tall_earth' src='p1_earth_tall.png' alt='' width='100' height='100' />
  <span class = 'image_text'>
    EMD = work of transformation
    <span class = 'arrow'>
      &#x21C4;
    </span>
  </span>
  <img style='display: inline; margin-top: -100px; margin-left: -10px;' title='short_earth' src='p1_earth_short.png' alt='' width='137.5' height='100' />
</div>

        <div class = 'p1_paras'>
  <p>
    As shown above, EMD represents the <span class = 'hint'>work or energy needed to complete a transformation between densities</span>, which can be represented as different piles of earth. Thus, for our dataset we take every month between 1982-2012 and compute the 70 year change in temperature. An example calculation would be January of 2012 - January of 1942. With 12 months x 31 years = 372 measurments per country we have sufficient datapoints to create a reasonably detailed histogram, using <span class = 'package'>hist</span> and each countries' change in temperature from the early 1900s to the early 2000s. While we could have just used the 12 months from one year in the past and one year in the present, we don't believe that is accurate because a single monthly fluke or an entire yearly fluke in temperature could cause the data to vary wildly. Using a range of 30 years allows us to account for potential flukes in temperature measurments, providing us with a more accurate story of how mean land temperatures have changed from the past to the present. We standarize these histograms by using the same binwidth, number of bins, and min and max on the x-axis. These histograms can be used as densities by accessing the <span class = 'package'>hist$density</span> value, we then pass these into a custom function that computes the distance matrix via the Wasserstein distance function, specifically <span class = 'package'>wasserstein1d</span> from the <span class = 'package'>transport</span> package. We then use a heatmap similar to the one in the previous section to plot a "correlation matrix", essentially just a distance matrix, of the EMD between different countries. In this case, we are interested to see if the previous geographical significance in the country clustering is still present post seasonal effect elimination by coloring on the mega regions defined in the previous section.
  </p>
</div>
        <div id="all_ct_emd_mega_corrmap" class="shiny-plot-output" style="width: 100% ; height: 400px"></div>
        <div class = 'p1_paras'>
  <p>
    As seen above, there appears to be some geographical significance in the clustering for the right most cluster, which appears to be exclusively from the "Europe & Central Asia" mega region. However, the other clusters appear to be less defined by a single mega region and are more <span class = 'hist'>heterogeneous in which mega regions they come from</span>. Therefore, to identify the location of these different groups, we again us <span class = 'package'>hclust</span> to identify clusters via <span class = 'package'>h = 0.5</span> and identify the clustering below.
  </p>
</div>
        <div id="all_ct_emd_grouped_corrmap" class="shiny-plot-output" style="width: 100% ; height: 400px"></div>
        <div class = 'p1_paras'>
  <p>
    One major difference between the clustering shown above, and the clustering in the previous section is the size of the clusters. While the previous section essentially had a north cluster and south cluster of countries, this clustering seems to be <span class = 'hint'>better distributed</span> and has <span class = 'hint'>more equally sized</span> clusters. To get an idea of each cluster's location and representative countries we plot these groups onto a world map below.
  </p>
</div>
        <div id="world_map_emd_grouped" style="width:100%; height:400px; " class="plotly html-widget html-widget-output shiny-report-size"></div>
        <div class = 'p1_paras'>
  <p>
    While the arrangement of these groups may seem meaningless upon first glance, identification of the equator and each group's relative position from such reveals a clear cut pattern. The groups are arranged such that they <span class = 'point'>represent different distances from the equator</span>. Group 3 lies upon the equator, group 4 is one step further, then group 2 and group 5 are the next step away, with group 1 being the furthest from the equator. As such, we reveal that <span class = 'hint'>latitude is a major player in the rate at which countries are increasing in their mean land temperature</span>. While this provides us with a more qualitative perspective on the impact of latitude on rate of average land temperature increase across time, we utilize a scatterplot, shown below, to provide a quantitative examination of change in temperature by latitude. We also provide two sliders, also below, to allow for custom filtering of both the absolute latitude (distance from the equator) and change in mean land temperature.
</div>
        <div class="form-group shiny-input-container">
          <label class="control-label" for="sp1_grouped_abs_lat_range">Range of Absolute Latitude</label>
          <input class="js-range-slider" id="sp1_grouped_abs_lat_range" data-type="double" data-min="0" data-max="75" data-from="0" data-to="75" data-step="1" data-grid="true" data-grid-num="9.375" data-grid-snap="false" data-prettify-separator="" data-prettify-enabled="false" data-keyboard="true" data-drag-interval="true" data-data-type="number"/>
        </div>
        <div class="form-group shiny-input-container">
          <label class="control-label" for="sp1_grouped_temp_range">Range of Temp Change (˚C)</label>
          <input class="js-range-slider" id="sp1_grouped_temp_range" data-type="double" data-min="0" data-max="1.5" data-from="0" data-to="1.5" data-step="0.02" data-grid="true" data-grid-num="9.375" data-grid-snap="false" data-prettify-separator="" data-prettify-enabled="false" data-keyboard="true" data-drag-interval="true" data-data-type="number"/>
        </div>
        <div id="emd_grouped_scatterplot" style="width:100%; height:400px; " class="plotly html-widget html-widget-output shiny-report-size"></div>
        <div class = 'p1_paras'>
  <p>
    While the arrangement of these groups may seem meaningless upon first glance, identification of the equator and each group's relative position from such reveals a clear cut pattern. The groups are arranged such that they <span class = 'point'>represent different distances from the equator</span>. Group 3 lies
        <div class="form-group shiny-input-container">
          <label class="control-label" for="sp1_mega_abs_lat_range">Range of Absolute Latitude</label>
          <input class="js-range-slider" id="sp1_mega_abs_lat_range" data-type="double" data-min="0" data-max="75" data-from="0" data-to="75" data-step="1" data-grid="true" data-grid-num="9.375" data-grid-snap="false" data-prettify-separator="" data-prettify-enabled="false" data-keyboard="true" data-drag-interval="true" data-data-type="number"/>
        </div>
        <div class="form-group shiny-input-container">
          <label class="control-label" for="sp1_mega_temp_range">Range of Temp Change (˚C)</label>
          <input class="js-range-slider" id="sp1_mega_temp_range" data-type="double" data-min="0" data-max="1.5" data-from="0" data-to="1.5" data-step="0.02" data-grid="true" data-grid-num="9.375" data-grid-snap="false" data-prettify-separator="" data-prettify-enabled="false" data-keyboard="true" data-drag-interval="true" data-data-type="number"/>
        </div>
        <div id="emd_mega_scatterplot" style="width:100%; height:400px; " class="plotly html-widget html-widget-output shiny-report-size"></div>
        <div class = 'p1_paras'>
  <p>
    hello
  </p>
</div>
      </div>
    </div>
    <div class="tab-pane" data-value="Disaster Count Per Year" id="tab-9880-2">
      <h2>Natural Disaster Count for Range of Years</h2>
      <div class="row">
        <div class="col-sm-4">
          <form class="well">
            <div id="disasters" class="form-group shiny-input-checkboxgroup shiny-input-container">
              <label class="control-label" for="disasters">Natural Disaster Categories</label>
              <div class="shiny-options-group">
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="All natural disasters" checked="checked"/>
                    <span>All natural disasters</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Drought" checked="checked"/>
                    <span>Drought</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Earthquake" checked="checked"/>
                    <span>Earthquake</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Extreme temperature" checked="checked"/>
                    <span>Extreme temperature</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Extreme weather" checked="checked"/>
                    <span>Extreme weather</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Flood" checked="checked"/>
                    <span>Flood</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Impact" checked="checked"/>
                    <span>Impact</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Landslide" checked="checked"/>
                    <span>Landslide</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Mass movement (dry)" checked="checked"/>
                    <span>Mass movement (dry)</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Volcanic activity" checked="checked"/>
                    <span>Volcanic activity</span>
                  </label>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="disasters" value="Wildfire" checked="checked"/>
                    <span>Wildfire</span>
                  </label>
                </div>
              </div>
            </div>
            <div class="form-group shiny-input-container">
              <label class="control-label" for="time_range">Range of Years</label>
              <input class="js-range-slider" id="time_range" data-type="double" data-min="1900" data-max="2015" data-from="1900" data-to="2015" data-step="1" data-grid="true" data-grid-num="9.58333333333333" data-grid-snap="false" data-prettify-separator="" data-prettify-enabled="false" data-keyboard="true" data-drag-interval="true" data-data-type="number"/>
            </div>
          </form>
        </div>
        <div class="col-sm-8">
          <div id="disaster_scatterplot" style="width:100%; height:400px; " class="plotly html-widget html-widget-output shiny-report-size"></div>
        </div>
      </div>
    </div>
    <div class="tab-pane" data-value="Change in Temperature Between Years" id="tab-9880-3">
      <h2></h2>
      <div class="row">
        <div class="col-sm-4">
          <form class="well">
            <div class="form-group shiny-input-container">
              <label class="control-label" for="p3_2year_range">Range of Years</label>
              <input class="js-range-slider" id="p3_2year_range" data-type="double" data-min="1743" data-max="2013" data-from="1743" data-to="2013" data-step="2" data-grid="true" data-grid-num="9.64285714285714" data-grid-snap="false" data-prettify-separator="" data-prettify-enabled="false" data-keyboard="true" data-drag-interval="true" data-data-type="number"/>
            </div>
          </form>
        </div>
        <div class="col-sm-8">
          <div id="temp_change_worldmap" style="width:100%; height:400px; " class="plotly html-widget html-widget-output shiny-report-size"></div>
        </div>
      </div>
    </div>
  </div>
</div>
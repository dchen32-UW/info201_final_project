---
title: "Midpoint Deliverable"
author: "Daniel Chen, Grace Teebken, Tanner Lauzon, Kellen Maier"
date: "05/26/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# import natural disaster and average temp by country cleaning functions
source("scripts/data_cleaning.R")
# import summary info calculation functions
source("scripts/summary_info.R")
# import aggregate table calculation functions
source("scripts/aggregate_table.R")
# import plot 1
source("scripts/plot1.R")
# import plot 2
source("scripts/plot2.R")
# import plot 3
source("scripts/plot3.R")

# load libraries
library(dplyr)
library(ggplot2)
library(countrycode)
```

## Introduction
This project will focus on global climate change impacts and consider temperature changes as well as natural disaster events. We aim to visualize trends in global disasters and temperature data. This will help illuminate areas that have been impacted by climate change the most. We hope that this project will lead to greater awareness of the extent of climate change impacts as well as an understanding of which areas need the most attention and resources for combating the effects of climate change.

## Data Cleaning
We will be examining **two datasets** for this deliverable. The first consists of *yearly average land temperatures per country*. The other consists of a combination of *yearly global average land temperatures* and *yearly count and total damages of natural disaster events*. We have already gathered the necessary data cleaning functions in `{r setup}` from `scripts/data_cleaning.R` and below we first gather all of the seperate csv files and load them in as dataframes.
```{r, cache=TRUE}
# DATASET 1
# gather average land temperature by country
avg_temp_by_country <-
  read.csv("data/kaggle_global_temp/GlobalLandTemperaturesByCountry.csv",
           stringsAsFactors = FALSE)

# DATASET 2
# gather global temperature averages
global_temp <-
  read.csv("data/kaggle_global_temp/GlobalTemperatures.csv",
           stringsAsFactors = FALSE)

# gather natural disaster counts
natural_disaster_count <-
  read.csv("data/kaggle_natural_disaster/number-of-natural-disaster-events.csv",
           stringsAsFactors = FALSE)

# gather natural disaster USD damages
natural_disaster_damage <-
  read.csv("data/kaggle_natural_disaster/economic-damage-from-natural-disasters.csv",
           stringsAsFactors = FALSE)
```


We then clean up and combine the individual dataframes to get our final datasets that we will be using in our further analyses.
```{r, cache=TRUE}
# DATASET 1
# get clean average temperature by country dataset
avg_country_temp_data <-
  get_clean_avg_country_temp(avg_temp_by_country)

# DATASET 2
# get clean combined natural disaster count, damage, and temp dataset
natural_disaster_data <-
  get_clean_natural_disaster(global_temp,
                             natural_disaster_count,
                             natural_disaster_damage)
```


## Summary Information

```{r}
# gather summary info for DATASET 1 - average country temperature
temp_summary_info <- get_summary_info_temp(avg_country_temp_data)

# gather summary info for DATASET 2 - natural disaster count, damage,
#   and associated global temperature
disaster_summary_info <- get_summary_info_disaster(natural_disaster_data)
```

Our first dataset, which has average temperatures by country, has **value here** entries. 

Our second dataset, which combines the natural disasters and temperatures by country, has **value here** entries.


## Aggregate Table
Next, we examine our dataset 1, the average land temperature 
```{r}
# gather aggregate table for DATASET 1 - average country temperature
temp_aggr_table <- get_aggr_table_temp(avg_country_temp_data)
knitr::kable(temp_aggr_table)
```



We then examine our dataset 2, the combined natural disaster dataset via an aggregate table, shown below, to view how natural disasters have *changed* both in their number of *occurences*, their total *damage*, and how *global temperatures* have also changed. Using an average of **30 years in the past**, *1912 to 1942*, and an average of **30 years in the present**, *1982 to 2012*, we compute the change in count and damage of natural disasters, and the associated change in global mean land and land+ocean temperatures. Furthermore, we computed the *impact* of each natural disasters by dividing its damage for the year by the number of occurences. This provides us with a quantitative measurment for the amount of damage the natural disaster causes per incident, and allows us to examine if a disaster is causing more damage per incident as time goes on. This aggregate table is then sorted from highest to lowest, descending order, by the *difference in economic damage* to focus on which types of natural disasters cause the greatest yearly damage on average.

```{r}
# gather aggregate table for DATASET 2 - natural disaster count, damage,
#   and associated global temperature
disaster_aggr_table <- get_aggr_table_disaster(natural_disaster_data)
knitr::kable(disaster_aggr_table)
```

As shown in the table above, we have also included the **All natural disasters** row as it gives a easier summary of how the total count and damage of natural disasters have changed throughought time along with their associated change in global mean temperatures. We can see from this **All natural disasters** row that not only has the global temperature increased, but the number of natural disasters along with their total yearly damage and impact (damage per incident) have also increased as well. While, **extreme weather** is the natural disaster with the *greatest increase in economic damage* (increased by ~28.8 billions of USD), earthquakes have the highest change in impact. This means that in the most recent 30 years, 1982 to 2012, **earthquakes** are now causing *significantly more damage per event* (increased by ~800 million per incident) than the past group of 30 years, 1912 to 1942. Of further concern is the universal increase in count of natural disasters, while **floods** have actually *decreased in impact*, perhaps we are now better equipped to mitigate its damage, they have *severely increased in the number of average occurences per year*. Overall, we can see that natural disasters, along with global temperatures, have increased both in their count and damage across time.


## Data Visualizations
This first chart shows the relationship between ___ and ___. 

```{r, warning=FALSE, message=FALSE}
world_map_temp_change(avg_country_temp_data)
```


This chart shows the relationship between ___ and ___.

```{r, warning=FALSE, message=FALSE}
#plot_two, still from temp file
trendline_nd_count_by_year(natural_disaster_data)
```


This chart shows the relationship between ___ and ___.

```{r, warning=FALSE, message=FALSE}
scatter_nd_count_by_temp(natural_disaster_data)
```

